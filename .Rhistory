summarize(count = n(Standing)) %>%
pivot_wider(names_from = name, values_from = count, values_fill = 0) %>%
ungroup() %>%
select(value,Winner,`Runners-Up`, Third, Fourth) %>%
rename(Country = "value") %>%
arrange(desc(Winner))
WC_dominance_summary <- WC_Events %>%
select(Country,Standing) %>%
group_by(Country) %>%
summarize(count(Standing)) %>%
pivot_wider(names_from = name, values_from = count, values_fill = 0) %>%
ungroup() %>%
select(value,Winner,`Runners-Up`, Third, Fourth) %>%
rename(Country = "value") %>%
arrange(desc(Winner))
WC_dominance_summary <- WC_Events %>%
select(Country, Standing)
View(WC_dominance_summary)
pivot_wider(names_from = Standing, values_from = count, values_fill = 0) %>%
arrange(desc(Winner))
WC_Events
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = count, values_fill = 0) %>%
arrange(desc(Winner))
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country, values_fill = 0) %>%
arrange(desc(Winner))
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country, values_fill = 0) %>%
arrange(desc(Winner))
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country) %>%
arrange(desc(Winner))
WC_Events
View(WC_dominance_summary)
arrange(desc(Winner))
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country) %>%
select(-Year) %>%
group_by(HostCountry)%>%
summarise(count(Winners), count(Runners-Up), count(Third), count(Fourth))
arrange(desc(Winner))
arrange(desc(Winner))
arrange(desc(Winner))
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country) %>%
select(-Year) %>%
group_by(HostCountry) %>%
summarise(count = n())
View(WC_dominance_summary)
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country) %>%
select(-Year) %>%
group_by(HostCountry) %>%
summarise(count = n())
View(WC_dominance_summary)
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country)
View(WC_dominance_summary)
WC_dominance_summary
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country) %>%
gather(key = "Standing", value = "Country", Winner:Fourth) %>%
group_by(Country) %>%
count(name = "Standing_count") %>%
arrange(desc(Standing_count))
WC_dominance_summary
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country) %>%
group_by(HostCountry, Standing) %>%
count() %>%
ungroup() %>%
pivot_wider(names_from = Standing, values_from = n, values_fill = 0)
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country)
WC_dominance_summary
WC_dominance_summary <- WC_Events %>%
select(-GoalsScored,-QualifiedTeams,-MatchesPlayed) %>%
pivot_wider(names_from = Standing, values_from = Country) %>%
group_by(HostCountry) %>%
count() %>%
ungroup() %>%
pivot_wider(names_from = Standing, values_from = n, values_fill = 0)
WC_Events
WC_dominance_summary <- WC_Events %>%
group_by(HostCountry, Standing) %>%
count() %>%
pivot_wider(names_from = Standing, values_from = n, values_fill = 0) %>%
rename(Winner = "Winner", `Runners-Up` = "Runners-Up", Third = "Third", Fourth = "Fourth")
WC_dominance_summary
WC_Events %>%
group_by(HostCountry, Standing) %>%
count()
WC_dominance_summary <- WC_dominance_summary %>% mutate(Times_in_Top4 = rowSums(across(Winner:Fourth)))
WC_dominance_summary %>%
pivot_longer(cols = -c(Country,Times_in_Top4), names_to = "Place", values_to = "Sum") %>%
mutate(Place = factor(Place, levels = c("Winner", "Runners-Up", "Third", "Fourth"))) %>%
mutate(Country = fct_reorder(Country, Sum, sum)) %>%
ggplot(aes(x = Country, y = Sum, fill = Place)) +
geom_col(position = "stack", color = "black") +
geom_text(aes(label = ifelse(Sum > 0, Sum, "")), position = position_stack(vjust = 0.5), size = 3) +
coord_flip() +
scale_fill_manual(values = c("#5DA5DA", "#FAA43A", "#60BD68", "#F17CB0")) +
labs(x = "", y = "Performances", fill = "") +
ggtitle("Top Performers in World Cup") +
theme_minimal() +
scale_y_continuous(limits = c(0, 12), breaks = seq(0,12,2))
WC_dominance_summary
WC_dominance_summary %>%
pivot_longer(cols = -c(HostCountry,Times_in_Top4), names_to = "Place", values_to = "Sum") %>%
mutate(Place = factor(Place, levels = c("Winner", "Runners-Up", "Third", "Fourth"))) %>%
mutate(Country = fct_reorder(Country, Sum, sum)) %>%
ggplot(aes(x = Country, y = Sum, fill = Place)) +
geom_col(position = "stack", color = "black") +
geom_text(aes(label = ifelse(Sum > 0, Sum, "")), position = position_stack(vjust = 0.5), size = 3) +
coord_flip() +
scale_fill_manual(values = c("#5DA5DA", "#FAA43A", "#60BD68", "#F17CB0")) +
labs(x = "", y = "Performances", fill = "") +
ggtitle("Top Performers in World Cup") +
theme_minimal() +
scale_y_continuous(limits = c(0, 12), breaks = seq(0,12,2))
WC_dominance_summary %>%
pivot_longer(cols = -c(HostCountry,Times_in_Top4), names_to = "Place", values_to = "Sum") %>%
mutate(Place = factor(Place, levels = c("Winner", "Runners-Up", "Third", "Fourth"))) %>%
mutate(Country = fct_reorder(HostCountry, Sum, sum)) %>%
ggplot(aes(x = Country, y = Sum, fill = Place)) +
geom_col(position = "stack", color = "black") +
geom_text(aes(label = ifelse(Sum > 0, Sum, "")), position = position_stack(vjust = 0.5), size = 3) +
coord_flip() +
scale_fill_manual(values = c("#5DA5DA", "#FAA43A", "#60BD68", "#F17CB0")) +
labs(x = "", y = "Performances", fill = "") +
ggtitle("Top Performers in World Cup") +
theme_minimal() +
scale_y_continuous(limits = c(0, 12), breaks = seq(0,12,2))
WC_Matches %>% filter(Year == 2022) %>% select (HomeTeam)
International_Matches_Transformed <-
International_Matches %>% pivot_longer(cols = c(HomeTeam, AwayTeam), names_to = "Home_Away", values_to = "Country") %>%
mutate(Goal_Scored = ifelse (Home_Away == "HomeTeam", HomeGoals, AwayGoals)) %>%
filter( Country %in% (WC_Groups$Team))
WC_Groups
International_Matches_Transformed_latest5 <- International_Matches_Transformed %>%
arrange(Country, Date) %>%  # sort by Country and Date
group_by(Country) %>%
slice_tail(n = 5)  # keep only the last 5 matches for each Country
International_Matches_Transformed_latest5 <- International_Matches_Transformed_latest5 %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw"
))
International_Matches_Transformed_latest5
International_Matches_Form <- International_Matches_Transformed_latest5 %>% select(Country, Result) %>%
mutate(Result_numeric = case_match(Result, "Win" ~ 3,  "Draw" ~ 1,  "Loss"  ~ 0)) %>%
group_by(Country) %>%
summarise(Total_point = sum(Result_numeric)) %>%
mutate(Form_B4_WC = case_when(Total_point>10 ~ "A", Total_point <5 ~ "C", .default = "B"))%>%
arrange(desc(Total_point))
International_Matches_Form
ggplot(data = International_Matches_Form, aes(x = Total_point, y = reorder(Country,Total_point), color = Form_B4_WC)) +
geom_point(size = 4) +
scale_color_manual(values = c("green", "blue", "red"), name = "Form_B4_WC") +
labs(x = "Total Points", y = "Country", title = "Team Performance Summary Based on last 5 matches") +
theme_bw() +
scale_x_continuous(breaks = seq(0, 15, by = 2))
WC2022_Performance <-WC_Groups %>% left_join(International_Matches_Form, by = c("Team" = "Country")) %>%
left_join(WC_dominance_summary, by = c("Team" = "Country")) %>%
replace_na(list(Times_in_Top4 = 0)) %>%
arrange(Team) %>%
mutate(Final_Standing_numeric = case_match(Final_Standing,"Winner" ~ 1, "Runners-Up"~2,"Third Place" ~ 3, "Fourth Place" ~ 4, "Top 8" ~ 5, "Top 16" ~ 6, .default = 7))
WC2022_Performance
WC2022_Performance <-WC_Groups %>% left_join(International_Matches_Form, by = c("Team" = "Country")) %>%
left_join(WC_dominance_summary, by = c("Team" = "Country")) %>%
replace_na(list(Times_in_Top4 = 0)) %>%
arrange(Team) %>%
mutate(Final_Standing_numeric = case_match(Final_Standing,"Winner" ~ 1, "Runners-Up"~2,"Third Place" ~ 3, "Fourth Place" ~ 4, "Top 8" ~ 5, "Top 16" ~ 6, .default = 7))
WC2022_Performance <-WC_Groups %>% left_join(International_Matches_Form, by = c("Team" = "Country")) %>%
left_join(WC_dominance_summary, by = c("Team" = "HostCountry")) %>%
replace_na(list(Times_in_Top4 = 0)) %>%
arrange(Team) %>%
mutate(Final_Standing_numeric = case_match(Final_Standing,"Winner" ~ 1, "Runners-Up"~2,"Third Place" ~ 3, "Fourth Place" ~ 4, "Top 8" ~ 5, "Top 16" ~ 6, .default = 7))
WC2022_Performance
WC2022_Performance$Final_Standing <- factor(WC2022_Performance$Final_Standing, levels = c("Group Stage", "Top 16", "Top 8", "Fourth Place", "Third Place", "Runners-Up", "Winner"))
ggplot(data = WC2022_Performance, aes(x = Final_Standing, y = Times_in_Top4, label = Team)) +
geom_point(size =2 , color = "black") +
ggrepel::geom_text_repel(aes(color = Form_B4_WC), size = 4, show.legend = TRUE, max.overlaps = Inf, nudge_x = 0.2, nudge_y = 0.2) +
scale_color_manual(values = c("green", "blue", "red"), name = "Form_B4_WC") +
labs(x = "Final Standing", y = "Times in Top 4", title = "Team Performance Summary Based on last 5 matches") +
theme_bw() +
scale_x_discrete(limits = c("Group Stage", "Top 16", "Top 8", "Fourth Place", "Third Place", "Runners-Up", "Winner"))
#Argentina 2022 road to glory compare to France 2018
WC_Matches
WC_Matches_Transformed <-
WC_Matches %>% pivot_longer(cols = c(HomeTeam, AwayTeam), names_to = "Home_Away", values_to = "Country") %>%
mutate(Goal_Scored = ifelse (Home_Away == "HomeTeam", HomeGoals, AwayGoals)) %>%
filter((Country == "France" & Year == 2018) | (Country =="Argentina" & Year == 2022))
WC_Matches_Transformed <- WC_Matches_Transformed %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw")) %>%
mutate(Result_numeric_steak = case_match(Result, "Win" ~ 1,  "Draw" ~ 0,  "Loss"  ~ -1), Result_numeric = cumsum(Result_numeric_streak)) %>%
arrange(Country,Date) %>%
group_by(Country) %>%
mutate(match_index = row_number())
WC_Matches_Transformed <-
WC_Matches %>% pivot_longer(cols = c(HomeTeam, AwayTeam), names_to = "Home_Away", values_to = "Country") %>%
mutate(Goal_Scored = ifelse (Home_Away == "HomeTeam", HomeGoals, AwayGoals)) %>%
filter((Country == "France" & Year == 2018) | (Country =="Argentina" & Year == 2022))
WC_Matches_Transformed <- WC_Matches_Transformed %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw")) %>%
mutate(Result_numeric_steak = case_match(Result, "Win" ~ 1,  "Draw" ~ 0,  "Loss"  ~ -1), Result_numeric = cumsum(Result_numeric_streak)) %>%
arrange(Country,Date) %>%
group_by(Country) %>%
mutate(match_index = row_number())
WC_Matches_Transformed <- WC_Matches_Transformed %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw")) %>%
mutate(Result_numeric_steak = case_match(Result, "Win" ~ 1,  "Draw" ~ 0,  "Loss"  ~ -1), Result_numeric = cumsum(Result_numeric_streak)) %>%
arrange(Country,Date) %>%
group_by(Country) %>%
mutate(match_index = row_number())
WC_Matches_Transformed <- WC_Matches_Transformed %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw")) %>%
mutate(Result_numeric_steak = case_match(Result, "Win" ~ 1,  "Draw" ~ 0,  "Loss"  ~ -1)) %>%
arrange(Country,Date) %>%
group_by(Country) %>%
mutate(match_index = row_number())
# plot Year vs. Result_Numeric with Country as the grouping variable
ggplot(WC_Matches_Transformed, aes(x = match_index, y = Result_numeric_streak, color = Country)) +
geom_line(size = 1) + geom_point(size =2) +
geom_text(aes(label = paste(Result, ifelse(is.na(WinCondition),"",WinCondition), sep = "\n")),
hjust = -0.1, size = 3, show.legend = FALSE, color = "black")  +
labs(title = "Road to glory Argentina 2022 vs 2018 France",
x = "Match Index",
y = "Result",
color = "Country") +
scale_color_manual(values = c("#75AADB", "darkblue")) +
facet_wrap(~Country, ncol = 2) +
theme(axis.text.y = element_blank())
WC_Matches_Transformed <- WC_Matches_Transformed %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw")) %>%
mutate(Result_numeric_steak = case_match(Result, "Win" ~ 1,  "Draw" ~ 0,  "Loss"  ~ -1)) %>%
arrange(Country,Date) %>%
group_by(Country) %>%
mutate(match_index = row_number())
WC_Matches_Transformed
# plot Year vs. Result_Numeric with Country as the grouping variable
ggplot(WC_Matches_Transformed, aes(x = match_index, y = Result_numeric_streak, color = Country)) +
geom_line(size = 1) + geom_point(size =2) +
geom_text(aes(label = paste(Result, ifelse(is.na(WinCondition),"",WinCondition), sep = "\n")),
hjust = -0.1, size = 3, show.legend = FALSE, color = "black")  +
labs(title = "Road to glory Argentina 2022 vs 2018 France",
x = "Match Index",
y = "Result",
color = "Country") +
scale_color_manual(values = c("#75AADB", "darkblue")) +
facet_wrap(~Country, ncol = 2) +
theme(axis.text.y = element_blank())
ggplot(WC_Matches_Transformed, aes(x = match_index, y = Result_numeric_streak, color = Country)) +
geom_line(size = 1) + geom_point(size =2) +
geom_text(aes(label = paste(Result, ifelse(is.na(WinCondition),"",WinCondition), sep = "\n")),
hjust = -0.1, size = 3, show.legend = FALSE, color = "black")  +
labs(title = "Road to glory Argentina 2022 vs 2018 France",
x = "Match Index",
y = "Result",
color = "Country") +
scale_color_manual(values = c("#75AADB", "darkblue")) +
facet_wrap(~Country, ncol = 2) +
theme(axis.text.y = element_blank())
WC_Matches_Transformed <- WC_Matches_Transformed %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw")) %>%
mutate(Result_numeric_steak = case_match(Result, "Win" ~ 1,  "Draw" ~ 0,  "Loss"  ~ -1)) %>%
arrange(Country,Date) %>%
group_by(Country) %>%
mutate(match_index = row_number())
WC_Matches_Transformed
# plot Year vs. Result_Numeric with Country as the grouping variable
ggplot(WC_Matches_Transformed, aes(x = match_index, y = Result_numeric_streak, color = Country)) +
geom_line(size = 1) + geom_point(size =2) +
geom_text(aes(label = paste(Result, ifelse(is.na(WinCondition),"",WinCondition), sep = "\n")),
hjust = -0.1, size = 3, show.legend = FALSE, color = "black")  +
labs(title = "Road to glory Argentina 2022 vs 2018 France",
x = "Match Index",
y = "Result",
color = "Country") +
scale_color_manual(values = c("#75AADB", "darkblue")) +
facet_wrap(~Country, ncol = 2) +
theme(axis.text.y = element_blank())
View(WC_Matches_Transformed)
# plot Year vs. Result_Numeric with Country as the grouping variable
ggplot(WC_Matches_Transformed, aes(x = match_index, y = Result_numeric_streak, color = Country)) +
geom_line(size = 1) + geom_point(size =2) +
geom_text(aes(label = paste(Result, ifelse(is.na(WinCondition),"",WinCondition), sep = "\n")),
hjust = -0.1, size = 3, show.legend = FALSE, color = "black")  +
labs(title = "Road to glory Argentina 2022 vs 2018 France",
x = "Match Index",
y = "Result",
color = "Country") +
scale_color_manual(values = c("#75AADB", "darkblue")) +
facet_wrap(~Country, ncol = 2) +
theme(axis.text.y = element_blank())
WC_Matches_Transformed <- WC_Matches_Transformed %>%
mutate(Result = case_when(
Home_Away == "HomeTeam" & HomeGoals > AwayGoals ~ "Win",
Home_Away == "HomeTeam" & HomeGoals < AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals > AwayGoals ~ "Loss",
Home_Away == "AwayTeam" & HomeGoals < AwayGoals ~ "Win",
TRUE ~ "Draw")) %>%
mutate(Result_numeric_streak = case_match(Result, "Win" ~ 1,  "Draw" ~ 0,  "Loss"  ~ -1)) %>%
arrange(Country,Date) %>%
group_by(Country) %>%
mutate(match_index = row_number())
# plot Year vs. Result_Numeric with Country as the grouping variable
ggplot(WC_Matches_Transformed, aes(x = match_index, y = Result_numeric_streak, color = Country)) +
geom_line(size = 1) + geom_point(size =2) +
geom_text(aes(label = paste(Result, ifelse(is.na(WinCondition),"",WinCondition), sep = "\n")),
hjust = -0.1, size = 3, show.legend = FALSE, color = "black")  +
labs(title = "Road to glory Argentina 2022 vs 2018 France",
x = "Match Index",
y = "Result",
color = "Country") +
scale_color_manual(values = c("#75AADB", "darkblue")) +
facet_wrap(~Country, ncol = 2) +
theme(axis.text.y = element_blank())
View(WC_Matches_Transformed)
Total_Goal_Scored <- WC_Matches_Transformed %>%
group_by(Country) %>%
summarize(Total_Goals_Scored = sum(ifelse(Home_Away == "HomeTeam", HomeGoals, AwayGoals)),
Total_Goals_Conceded = sum(ifelse(Home_Away == "HomeTeam", AwayGoals, HomeGoals))) %>%
ggplot(aes(x = Country, y = Total_Goals_Scored, fill = Country)) +
geom_col(position = "dodge") +
geom_text(aes(label=Total_Goals_Scored), position=position_dodge(width=0.9), vjust=-0.5) +
facet_wrap(~ .) +
labs(title = "Total Goals Scored",
x = NULL, y = NULL) +
guides(fill=FALSE) +
scale_fill_manual(values = c("#75AADB", "darkblue")) +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
Total_Goal_Scored <- WC_Matches_Transformed %>%
group_by(Country) %>%
summarize(Total_Goals_Scored = sum(ifelse(Home_Away == "HomeTeam", HomeGoals, AwayGoals)),
Total_Goals_Conceded = sum(ifelse(Home_Away == "HomeTeam", AwayGoals, HomeGoals))) %>%
ggplot(aes(x = Country, y = Total_Goals_Scored, fill = Country)) +
geom_col(position = "dodge") +
geom_text(aes(label=Total_Goals_Scored), position=position_dodge(width=0.9), vjust=-0.5) +
facet_wrap(~ .) +
labs(title = "Total Goals Scored",
x = NULL, y = NULL) +
guides(fill=FALSE) +
scale_fill_manual(values = c("#75AADB", "darkblue")) +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
Total_Goal_Conceded <- WC_Matches_Transformed %>%
group_by(Country) %>%
summarize(Total_Goals_Scored = sum(ifelse(Home_Away == "HomeTeam", HomeGoals, AwayGoals)),
Total_Goals_Conceded = sum(ifelse(Home_Away == "HomeTeam", AwayGoals, HomeGoals))) %>%
ggplot(aes(x = Country, y = Total_Goals_Conceded, fill = Country)) +
geom_col(position = "dodge") +
geom_text(aes(label=Total_Goals_Conceded), position=position_dodge(width=0.9), vjust=-0.5) +
facet_wrap(~ .) +
labs(title = "Total Goals Conceded",
x = NULL, y = NULL) +
guides(fill=FALSE) +
scale_fill_manual(values = c("#75AADB", "darkblue")) +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
grid.arrange(Total_Goal_Scored + scale_y_continuous(limits = c(0, 20), expand = c(0, 0)),
Total_Goal_Conceded + scale_y_continuous(limits = c(0, 20), expand = c(0, 0)),
ncol = 2, widths = c(4, 4), top = "Argentina vs France World Cup Stats")
Total_Goal_Scored <- WC_Matches_Transformed %>%
group_by(Country) %>%
summarize(Total_Goals_Scored = sum(ifelse(Home_Away == "HomeTeam", HomeGoals, AwayGoals)),
Total_Goals_Conceded = sum(ifelse(Home_Away == "HomeTeam", AwayGoals, HomeGoals))) %>%
ggplot(aes(x = Country, y = Total_Goals_Scored, fill = Country)) +
geom_col(position = "dodge") +
geom_text(aes(label=Total_Goals_Scored), position=position_dodge(width=0.9), vjust=-0.5) +
facet_wrap(~ .) +
labs(title = "Total Goals Scored",
x = NULL, y = NULL) +
guides(fill=FALSE) +
scale_fill_manual(values = c("#75AADB", "darkblue")) +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
Total_Goal_Conceded <- WC_Matches_Transformed %>%
group_by(Country) %>%
summarize(Total_Goals_Scored = sum(ifelse(Home_Away == "HomeTeam", HomeGoals, AwayGoals)),
Total_Goals_Conceded = sum(ifelse(Home_Away == "HomeTeam", AwayGoals, HomeGoals))) %>%
ggplot(aes(x = Country, y = Total_Goals_Conceded, fill = Country)) +
geom_col(position = "dodge") +
geom_text(aes(label=Total_Goals_Conceded), position=position_dodge(width=0.9), vjust=-0.5) +
facet_wrap(~ .) +
labs(title = "Total Goals Conceded",
x = NULL, y = NULL) +
guides(fill=FALSE) +
scale_fill_manual(values = c("#75AADB", "darkblue")) +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"))
grid.arrange(Total_Goal_Scored + scale_y_continuous(limits = c(0, 20), expand = c(0, 0)),
Total_Goal_Conceded + scale_y_continuous(limits = c(0, 20), expand = c(0, 0)),
ncol = 2, widths = c(4, 4), top = "Argentina vs France World Cup Stats")
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R")
WC_Events
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R", "github_document")
#Using the temp_data to join and retrieve the readable data
temp_data <- read_csv("data/Fifa_world_cup_matches.csv", col_names = TRUE)
head(temp_data)
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R")
sink.close()
sink.close()
rmarkdown::render("R_Script.R")
options(sink.number=10)
rmarkdown::render("R_Script.R")
options(sink.number=100)
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R")
sink()
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R")
Qatar_Average_Goal_Scored <- Summarised_QatarPerformance$Average_Goal_Scored
Qatar_Average_Goal_Conceded <- Summarised_QatarPerformance$Average_Goal_Conceded
# Chart with only Average Goal Scored
ggplot(data = Summarised_HostPerformance, aes(x = Year, y = Average_Goal_Scored)) +
geom_line(color = "red", size = 1, alpha = 0.5) +
ggtitle("Host Country Average Goal Scored Per Match") +
theme(axis.title.y = element_text(size = 12), axis.text.y = element_text(size = 10)) +
scale_x_continuous(limits = c(1930, 2022), breaks = seq(1930, 2022, 4)) +
scale_y_continuous(breaks = seq(0, max(Summarised_HostPerformance$Average_Goal_Scored), 0.5)) +
ylab("Average Goals") +
xlab("Year") +
geom_hline(aes(yintercept = Qatar_Average_Goal_Scored, linetype = "Average Goals Scored"),
color = "red", linetype = "dashed") +
scale_linetype_manual(values=c("dashed"), guide = "none") +
geom_label(aes(x = max(Year), y = Qatar_Average_Goal_Scored, label = "Qatar"),
color = "black", size = 5, vjust = 1, hjust = -0.1) +
geom_text(aes(label = round(Average_Goal_Scored, 1)), nudge_y = 0.1, hjust = -0.2, size = 3.5) +
theme(legend.position = "none")
rmarkdown::render("R_Script.R")
options(max.print = 100)
rmarkdown::render("R_Script.R")
rmarkdown::render("R_Script.R", "github_document")
rmarkdown::render("R_Script.R", "github_document")
rmarkdown::render("R_Script.R", "github_document")
rmarkdown::render("R_Script.R", "github_document", eval =FALSE)
rmarkdown::render("R_Script.R", "github_document")
rmarkdown::render("R_Script.R", "github_document")
getwd()
setwd(getwd())
rmarkdown::render("R_Script.R", "github_document")
rmarkdown::render("R_Script.R", "github_document")
getwd()
git remote add origin https://github.com/hoangp27/Analysis-of-WorldCup-2022.git
git remote add origin https://github.com/hoangp27/Analysis-of-WorldCup-2022.git
